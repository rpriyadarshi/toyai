% SAGE Publications Book Template
% Understanding Transformers: From First Principles to Mastery
% Prepared for SAGE Publications submission

\documentclass[12pt,openany]{book}

% Page geometry - SAGE prefers standard margins
\usepackage[letterpaper,margin=1in]{geometry}

% Double spacing (SAGE requirement)
\usepackage{setspace}
\doublespacing

% Fonts - Use standard fonts compatible with SAGE production
% Note: SAGE will handle final font selection, but we use standard fonts here
% Check if we're using XeLaTeX/LuaLaTeX (fontspec) or pdfLaTeX (times)
\RequirePackage{iftex}
\ifXeTeX
    % XeLaTeX - use fontspec
    \usepackage{fontspec}
    \setmainfont{Times New Roman}
    \setsansfont{Arial}
    \setmonofont{Courier New}
\else
    \ifLuaTeX
        % LuaLaTeX - use fontspec
        \usepackage{fontspec}
        \setmainfont{Times New Roman}
        \setsansfont{Arial}
        \setmonofont{Courier New}
    \else
        % pdfLaTeX - use times package
        \usepackage{times}
        \usepackage{mathptmx}  % Math in Times
    \fi
\fi

% Math packages (SAGE requires editable equations, not images)
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mathtools}

% Graphics and images
% SAGE requires high-quality figures (300 dpi minimum)
\usepackage{graphicx}
\usepackage{svg}  % For SVG inclusion (requires inkscape)
\usepackage{adjustbox}  % For image scaling

% Tables
\usepackage{longtable}  % For multi-page tables
\usepackage{booktabs}  % For better table formatting

% Index and bibliography
% SAGE requires .bib and .bst files to be included
\usepackage{makeidx}  % For index generation
\makeindex

% Bibliography - SAGE will format according to their style
% Include your .bib file with submission
\usepackage{natbib}
% Use a standard style - SAGE will convert to their house style
\bibliographystyle{plainnat}

% Hyperlinks (for review/editing - SAGE may remove in final production)
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    urlcolor=blue,
    citecolor=blue,
    bookmarksopen=true,
    bookmarksopenlevel=2
}

% Code listings
\usepackage{listings}
\usepackage{xcolor}

% Listings configuration for C++
\lstset{
    language=C++,
    basicstyle=\ttfamily\small,
    keywordstyle=\color{blue}\bfseries,
    commentstyle=\color{green!60!black},
    stringstyle=\color{red},
    numberstyle=\tiny\color{gray},
    numbers=left,
    numbersep=5pt,
    frame=single,
    breaklines=true,
    breakatwhitespace=true,
    tabsize=4,
    showstringspaces=false,
    captionpos=b
}

% Theorem environments
\theoremstyle{definition}
\newtheorem{definition}{Definition}[chapter]
\newtheorem{example}{Example}[chapter]

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}

% Custom commands
\newcommand{\vect}[1]{\mathbf{#1}}
\newcommand{\mat}[1]{\mathbf{#1}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}

% Pandoc compatibility commands
\newcommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

% Pandoc table column width compatibility
\newcommand{\real}[1]{#1}

% SAGE-specific notes:
% - No headers or footers (SAGE will add these in production)
% - All equations must be editable (use LaTeX math, not images)
% - Figures should be 300 dpi minimum
% - Include .bib and .bst files with submission
% - Double-spaced throughout (already set above)

% Title page information (will be set by build script)
\title{Understanding Transformers: From First Principles to Mastery}
\author{ToyAI Educational Project}
\date{\today}

% Document structure
\begin{document}

% Front matter
\frontmatter

% Title page
\maketitle

% Copyright page (SAGE will handle final copyright page)
\thispagestyle{empty}
\vspace*{\fill}
\begin{center}
\small
Copyright \copyright\ \the\year\ ToyAI Educational Project\\
All rights reserved.
\end{center}
\vspace*{\fill}
\cleardoublepage

% Table of contents
\tableofcontents
\cleardoublepage

% List of figures
\listoffigures
\cleardoublepage

% List of tables
\listoftables
\cleardoublepage

% Preface (front matter - no chapter numbering)
\chapter*{Preface}
\addcontentsline{toc}{chapter}{Preface}
% Preface content will be included here by build script
\cleardoublepage

% Detailed Table of Contents (front matter - optional, for markdown navigation)
% TOC content will be included here by build script if present
\cleardoublepage

% Main matter
\mainmatter

% Chapters will be included here by build script
% \input{chapters/chapter01.tex}
% \input{chapters/chapter02.tex}
% etc.

% Back matter
\backmatter

% Bibliography
% SAGE requires .bib file to be included with submission
% They will format according to their house style
\bibliography{references}
\cleardoublepage

% Subject Index
\printindex
\cleardoublepage

\end{document}
