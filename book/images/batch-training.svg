<svg width="530" height="460" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .batch-box { fill: #e1f5ff; stroke: #2563eb; stroke-width: 2.5; rx: 8; }
      .process-box { fill: #fff4e1; stroke: #f59e0b; stroke-width: 2.5; rx: 8; }
      .gradient-box { fill: #f3e5f5; stroke: #9333ea; stroke-width: 2.5; rx: 8; }
      .avg-box { fill: #fff9c4; stroke: #f59e0b; stroke-width: 2.5; rx: 8; }
      .update-box { fill: #e8f5e9; stroke: #16a34a; stroke-width: 2.5; rx: 8; }
      .box-label { font-family: Arial, sans-serif; font-size: 13px; font-weight: bold; fill: #1e293b; }
      .box-text { font-family: Arial, sans-serif; font-size: 11px; fill: #64748b; }
      .arrow { stroke: #2563eb; stroke-width: 2.5; fill: none; marker-end: url(#arrow-blue); }
    </style>
    <marker id="arrow-blue" markerWidth="6" markerHeight="6" refX="5" refY="2" orient="auto">
      <polygon points="0 0, 6 2, 0 4" fill="#2563eb"/>
    </marker>
  </defs>
  
  <!-- Batch -->
  <g transform="translate(280, 20)">
    <rect x="0" y="0" width="100" height="60" class="batch-box"/>
    <text x="50" y="30" class="box-label" text-anchor="middle">Batch</text>
    <text x="50" y="48" class="box-text" text-anchor="middle">4 Examples</text>
  </g>
  
  <!-- Process boxes -->
  <g transform="translate(20, 110)">
    <rect x="0" y="0" width="100" height="60" class="process-box"/>
    <text x="50" y="30" class="box-label" text-anchor="middle">Process</text>
    <text x="50" y="48" class="box-text" text-anchor="middle">Example 1</text>
  </g>
  
  <g transform="translate(150, 110)">
    <rect x="0" y="0" width="100" height="60" class="process-box"/>
    <text x="50" y="30" class="box-label" text-anchor="middle">Process</text>
    <text x="50" y="48" class="box-text" text-anchor="middle">Example 2</text>
  </g>
  
  <g transform="translate(280, 110)">
    <rect x="0" y="0" width="100" height="60" class="process-box"/>
    <text x="50" y="30" class="box-label" text-anchor="middle">Process</text>
    <text x="50" y="48" class="box-text" text-anchor="middle">Example 3</text>
  </g>
  
  <g transform="translate(410, 110)">
    <rect x="0" y="0" width="100" height="60" class="process-box"/>
    <text x="50" y="30" class="box-label" text-anchor="middle">Process</text>
    <text x="50" y="48" class="box-text" text-anchor="middle">Example 4</text>
  </g>
  
  <!-- Gradient boxes -->
  <g transform="translate(20, 200)">
    <rect x="0" y="0" width="100" height="50" class="gradient-box"/>
    <text x="50" y="30" class="box-label" text-anchor="middle">Gradient 1</text>
  </g>
  
  <g transform="translate(150, 200)">
    <rect x="0" y="0" width="100" height="50" class="gradient-box"/>
    <text x="50" y="30" class="box-label" text-anchor="middle">Gradient 2</text>
  </g>
  
  <g transform="translate(280, 200)">
    <rect x="0" y="0" width="100" height="50" class="gradient-box"/>
    <text x="50" y="30" class="box-label" text-anchor="middle">Gradient 3</text>
  </g>
  
  <g transform="translate(410, 200)">
    <rect x="0" y="0" width="100" height="50" class="gradient-box"/>
    <text x="50" y="30" class="box-label" text-anchor="middle">Gradient 4</text>
  </g>
  
  <!-- Average -->
  <g transform="translate(220, 280)">
    <rect x="0" y="0" width="200" height="80" class="avg-box"/>
    <text x="100" y="25" class="box-label" text-anchor="middle">Average Gradients</text>
    <text x="100" y="45" class="box-text" text-anchor="middle" font-size="10">∇L = (∇L₁+∇L₂</text>
    <text x="100" y="60" class="box-text" text-anchor="middle" font-size="10">+∇L₃+∇L₄)/4</text>
  </g>
  
  <!-- Update -->
  <g transform="translate(245, 390)">
    <rect x="0" y="0" width="150" height="50" class="update-box"/>
    <text x="75" y="30" class="box-label" text-anchor="middle">Update Weights</text>
    <text x="75" y="45" class="box-text" text-anchor="middle">Once per Batch</text>
  </g>
  
  <!-- Arrows from Batch to Process -->
  <path d="M 330 80 L 70 110" class="arrow"/>
  <path d="M 330 80 L 200 110" class="arrow"/>
  <path d="M 330 80 L 330 110" class="arrow"/>
  <path d="M 330 80 L 460 110" class="arrow"/>
  
  <!-- Arrows from Process to Gradient -->
  <path d="M 70 170 L 70 200" class="arrow"/>
  <path d="M 200 170 L 200 200" class="arrow"/>
  <path d="M 330 170 L 330 200" class="arrow"/>
  <path d="M 460 170 L 460 200" class="arrow"/>
  
  <!-- Arrows from Gradient to Average -->
  <path d="M 70 250 L 220 280" class="arrow"/>
  <path d="M 200 250 L 270 280" class="arrow"/>
  <path d="M 330 250 L 320 280" class="arrow"/>
  <path d="M 460 250 L 370 280" class="arrow"/>
  
  <!-- Arrow from Average to Update -->
  <path d="M 320 360 L 320 390" class="arrow"/>
</svg>

