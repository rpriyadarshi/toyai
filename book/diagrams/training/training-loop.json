{
  "metadata": {
    "id": "training-loop",
    "title": "Training Loop",
    "width": 215,
    "height": 590
  },
  "components": [
    {
      "id": "start",
      "type": "input",
      "template": "input_box",
      "position": {"x": 20, "y": 20},
      "width": 150,
      "height": 50,
      "visual": {
        "class": "start-box"
      },
      "custom_text": {
        "label": "Start Training",
        "subtext": null
      }
    },
    {
      "id": "forward",
      "type": "simple",
      "template": "simple_box",
      "position": {"x": 20, "y": 110},
      "width": 150,
      "height": 60,
      "visual": {
        "class": "forward-box"
      },
      "custom_text": {
        "label": "Forward Pass",
        "subtext": "Compute Prediction"
      }
    },
    {
      "id": "loss",
      "type": "simple",
      "template": "simple_box",
      "position": {"x": 20, "y": 210},
      "width": 150,
      "height": 60,
      "visual": {
        "class": "loss-box"
      },
      "custom_text": {
        "label": "Compute Loss",
        "subtext": "Measure Error"
      }
    },
    {
      "id": "backward",
      "type": "simple",
      "template": "simple_box",
      "position": {"x": 20, "y": 310},
      "width": 150,
      "height": 60,
      "visual": {
        "class": "backward-box"
      },
      "custom_text": {
        "label": "Backward Pass",
        "subtext": "Compute Gradients"
      }
    },
    {
      "id": "update",
      "type": "simple",
      "template": "simple_box",
      "position": {"x": 20, "y": 410},
      "width": 150,
      "height": 70,
      "visual": {
        "class": "update-box"
      },
      "custom_text": {
        "label": "Weight Update",
        "subtext": "W_new = W_old\\n- η×grad"
      }
    },
    {
      "id": "stop",
      "type": "output",
      "template": "output_box",
      "position": {"x": 20, "y": 520},
      "width": 150,
      "height": 50,
      "visual": {
        "class": "stop-box"
      },
      "custom_text": {
        "label": "Stop",
        "subtext": "Model Trained"
      }
    }
  ],
  "connections": [
    {
      "from": "start.output",
      "to": "forward.input",
      "style": "forward"
    },
    {
      "from": "forward.output",
      "to": "loss.input",
      "style": "forward"
    },
    {
      "from": "loss.output",
      "to": "backward.input",
      "style": "forward"
    },
    {
      "from": "backward.output",
      "to": "update.input",
      "style": "forward"
    },
    {
      "from": "update.output",
      "to": "stop.input",
      "style": "forward",
      "label": "Converged"
    },
    {
      "from": "stop.output",
      "to": "forward.input",
      "style": "training",
      "routing": "polyline",
      "color": "#9333ea",
      "label": "Repeat",
      "metadata": {
        "dasharray": "5,5"
      }
    }
  ],
  "labels": []
}

